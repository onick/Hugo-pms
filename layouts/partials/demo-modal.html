<style>
/* â”€â”€ Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#demo-overlay {
  display: none; position: fixed; inset: 0; z-index: 9999;
  background: rgba(10,10,10,0.6);
  backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
  align-items: flex-end; justify-content: center;
}
#demo-overlay.open { display: flex; }
@media (min-width: 640px) { #demo-overlay { align-items: center; } }

/* â”€â”€ Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#demo-card {
  background: #fff; width: 100%; max-width: 680px;
  border-radius: 20px 20px 0 0; max-height: 92vh;
  display: flex; flex-direction: column; overflow: hidden;
  animation: dmCardIn 0.32s cubic-bezier(0.34,1.2,0.64,1);
  position: relative;
}
@media (min-width: 640px) { #demo-card { border-radius: 20px; max-height: 88vh; } }
@keyframes dmCardIn {
  from { opacity:0; transform:translateY(40px); }
  to   { opacity:1; transform:translateY(0); }
}

/* â”€â”€ Inner (split) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#dm-inner { display: flex; flex-direction: column; flex: 1; overflow: hidden; min-height: 0; }
@media (min-width: 640px) { #dm-inner { flex-direction: row; } }

/* â”€â”€ LEFT panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#dm-left {
  background: #F7F7F2; padding: 1.5rem 1.5rem 1rem;
  flex-shrink: 0;
}
@media (min-width: 640px) {
  #dm-left { width: 210px; padding: 2.5rem 1.75rem; display:flex; flex-direction:column; justify-content:center; }
}
#dm-left-title {
  font-family: var(--font-sans); font-size: 1.15rem;
  font-weight: 700; color: #0A0A0A; line-height: 1.2; margin-bottom: 0.4rem;
}
#dm-left-sub {
  font-family: var(--font-sans); font-size: 0.8rem; color: #6b7280; line-height: 1.5;
}
.dm-dots { display:none; flex-direction:column; gap:5px; margin-top:1.75rem; }
@media (min-width:640px) { .dm-dots { display:flex; } }
.dm-dot { width:5px; height:5px; border-radius:50%; background:#d1d5db; transition:all 0.25s; }
.dm-dot.active { background:#1A3320; height:16px; border-radius:3px; }
.dm-dot.done   { background:#1A3320; }

/* â”€â”€ RIGHT: content area â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#dm-right { flex:1; overflow:hidden; position:relative; min-height:300px; }

/* â”€â”€ Slides â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dm-slide {
  position:absolute; inset:0; padding:1.5rem 1.5rem 0; overflow-y:auto;
  opacity:0; transform:translateY(26px); pointer-events:none; transition:none;
}
@media (min-width:640px) { .dm-slide { padding:2rem 1.75rem 0; } }
.dm-slide.active { opacity:1; transform:translateY(0); pointer-events:all; transition:opacity 0.28s ease, transform 0.28s ease; }
.dm-slide.exit-up { opacity:0; transform:translateY(-20px); pointer-events:none; transition:opacity 0.2s ease, transform 0.2s ease; }

/* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#dm-footer {
  display:flex; align-items:center; justify-content:space-between;
  padding:0.875rem 1.5rem; border-top:1px solid #f3f4f6;
  flex-shrink:0; background:#fff; gap:1rem;
}
@media (min-width:640px) { #dm-footer { padding:0.875rem 1.75rem; } }
#dm-back-btn {
  background:none; border:none; font-family:var(--font-sans); font-size:13px;
  color:#6b7280; cursor:pointer; padding:6px 0; min-width:70px;
}
#dm-back-btn:hover { color:#111; }
#dm-back-btn.hidden { visibility:hidden; }
#dm-counter { font-family:var(--font-sans); font-size:13px; color:#9ca3af; white-space:nowrap; }
#dm-next-btn {
  background:#E9FF57; color:#0A0A0A; border:none; border-radius:10px;
  padding:11px 22px; font-family:var(--font-sans); font-size:14px; font-weight:700;
  cursor:pointer; display:flex; align-items:center; gap:6px; transition:opacity 0.2s, transform 0.1s;
}
#dm-next-btn:hover { opacity:0.88; transform:translateX(1px); }
#dm-next-btn:disabled { opacity:0.4; cursor:not-allowed; transform:none; }

/* â”€â”€ Close â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#dm-close {
  position:absolute; top:0.875rem; right:0.875rem; z-index:10;
  width:28px; height:28px; border-radius:50%; border:none;
  background:rgba(0,0,0,0.07); cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  font-size:13px; color:#6b7280; transition:background 0.15s;
}
#dm-close:hover { background:rgba(0,0,0,0.13); }

/* â”€â”€ Type cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dm-type-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.dm-type-card {
  border:1.5px solid #e5e7eb; border-radius:10px; padding:11px 13px; cursor:pointer;
  display:flex; align-items:center; gap:9px;
  font-family:var(--font-sans); font-size:13px; font-weight:500; color:#111; transition:all 0.15s;
}
.dm-type-card:hover { border-color:#1A3320; background:#f9fafb; }
.dm-type-card.selected { border-color:#1A3320; background:#f0fdf4; box-shadow:0 0 0 1px #1A3320; }
.dm-radio { width:15px; height:15px; border-radius:50%; border:2px solid #d1d5db; margin-left:auto; flex-shrink:0; transition:all 0.15s; display:flex; align-items:center; justify-content:center; }
.dm-type-card.selected .dm-radio { border-color:#1A3320; background:#1A3320; }
.dm-type-card.selected .dm-radio::after { content:''; width:5px; height:5px; border-radius:50%; background:#fff; }

/* â”€â”€ Fields â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dm-field { margin-bottom:0.75rem; }
.dm-field label { display:block; font-family:var(--font-sans); font-size:12px; font-weight:600; color:#374151; margin-bottom:3px; }
.dm-field input, .dm-field select {
  width:100%; border:1.5px solid #e5e7eb; border-radius:9px;
  padding:9px 12px; font-family:var(--font-sans); font-size:14px;
  color:#111; outline:none; transition:border-color 0.15s; background:#fff; box-sizing:border-box;
}
.dm-field input:focus, .dm-field select:focus { border-color:#1A3320; box-shadow:0 0 0 3px rgba(26,51,32,0.08); }
.dm-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; }

/* â”€â”€ Checkboxes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dm-check-list { display:flex; flex-direction:column; gap:6px; margin-top:0.75rem; }
.dm-check-item {
  display:flex; align-items:center; gap:10px; border:1.5px solid #e5e7eb; border-radius:9px;
  padding:9px 12px; cursor:pointer; font-family:var(--font-sans); font-size:13px; color:#374151; transition:all 0.15s;
}
.dm-check-item:hover { border-color:#1A3320; background:#f9fafb; }
.dm-check-item.checked { border-color:#1A3320; background:#f0fdf4; }
.dm-check-item input[type="checkbox"] { accent-color:#1A3320; width:15px; height:15px; flex-shrink:0; }

/* â”€â”€ Success â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#dm-success { display:none; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:2.5rem 2rem; min-height:360px; }
#dm-success.show { display:flex; animation:dmCardIn 0.3s ease; }

@keyframes dmSpin { to { transform:rotate(360deg); } }
</style>

<div id="demo-overlay" onclick="if(event.target===this)closeDemoModal()">
<div id="demo-card">

  <button id="dm-close" onclick="closeDemoModal()">âœ•</button>

  <!-- SUCCESS -->
  <div id="dm-success">
    <div style="width:60px;height:60px;border-radius:50%;background:#f0fdf4;display:flex;align-items:center;justify-content:center;margin-bottom:1.25rem;">
      <svg width="30" height="30" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" fill="#1A3320"/>
        <path d="M7 12.5l3.5 3.5 6.5-7" stroke="#E9FF57" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <h2 style="font-family:var(--font-sans);font-size:1.35rem;font-weight:700;color:#0A0A0A;margin-bottom:0.6rem;">Â¡Solicitud recibida!</h2>
    <p style="font-family:var(--font-sans);font-size:14px;color:#6b7280;line-height:1.6;max-width:320px;margin-bottom:1.75rem;">
      Un especialista te contactarÃ¡ en <strong>menos de 24 horas</strong> para coordinar tu demo personalizada.
    </p>
    <a href="https://wa.me/{{ .Site.Params.demoWhatsApp }}?text=Hola,%20solicitÃ©%20una%20demo%20de%20Silex%20PMS"
       target="_blank" rel="noopener"
       style="display:inline-flex;align-items:center;gap:8px;background:#25D366;color:#fff;border-radius:12px;padding:12px 24px;font-family:var(--font-sans);font-size:14px;font-weight:700;text-decoration:none;margin-bottom:0.75rem;">
      <svg width="17" height="17" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.126.556 4.123 1.526 5.855L.057 23.25a.75.75 0 00.916.916l5.395-1.469A11.953 11.953 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-1.878 0-3.64-.49-5.172-1.348l-.37-.214-3.835 1.044 1.044-3.835-.214-.37A9.952 9.952 0 012 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z"/></svg>
      Escribir por WhatsApp
    </a>
    <button onclick="closeDemoModal()" style="background:none;border:none;font-family:var(--font-sans);font-size:13px;color:#9ca3af;cursor:pointer;">Cerrar</button>
  </div>

  <!-- SPLIT LAYOUT -->
  <div id="dm-inner">

    <!-- LEFT -->
    <div id="dm-left">
      <div id="dm-left-title">Solicitar demo â†’</div>
      <div id="dm-left-sub">Tipo de propiedad</div>
      <div class="dm-dots">
        <div class="dm-dot active" id="dd1"></div>
        <div class="dm-dot"        id="dd2"></div>
        <div class="dm-dot"        id="dd3"></div>
      </div>
    </div>

    <!-- RIGHT -->
    <div id="dm-right">

      <!-- Slide 1: tipo -->
      <div class="dm-slide active" id="dm-slide-1">
        <p style="font-family:var(--font-sans);font-size:13px;color:#6b7280;margin-bottom:0.875rem;">Â¿CuÃ¡l describe mejor tu negocio?</p>
        <div class="dm-type-grid">
          {{ range slice
            (slice "hotel"      "ğŸ¨" "Hotel")
            (slice "hostal"     "ğŸ›" "Hostal / Posada")
            (slice "resort"     "ğŸŒ´" "Resort")
            (slice "boutique"   "ğŸ¡" "Boutique / B&B")
            (slice "vacacional" "ğŸ”‘" "Alquiler vacacional")
            (slice "otro"       "ğŸ“‹" "Otro")
          }}{{ $t := . }}
          <div class="dm-type-card" data-value="{{ index $t 0 }}" onclick="selectType(this)">
            <span>{{ index $t 1 }}</span>
            <span>{{ index $t 2 }}</span>
            <span class="dm-radio"></span>
          </div>
          {{ end }}
        </div>
      </div>

      <!-- Slide 2: contacto -->
      <div class="dm-slide" id="dm-slide-2">
        <p style="font-family:var(--font-sans);font-size:13px;color:#6b7280;margin-bottom:0.875rem;">Veamos algunos detalles sobre tu propiedad</p>
        <div class="dm-row">
          <div class="dm-field"><label>Nombre *</label><input type="text" id="dm-nombre" placeholder="MarÃ­a GarcÃ­a" autocomplete="name"></div>
          <div class="dm-field"><label>Nombre del hotel *</label><input type="text" id="dm-hotel" placeholder="Hotel El Caribe"></div>
        </div>
        <div class="dm-row">
          <div class="dm-field"><label>Email *</label><input type="email" id="dm-email" placeholder="tu@hotel.com"></div>
          <div class="dm-field"><label>WhatsApp *</label><input type="tel" id="dm-tel" placeholder="+1 (809) 000-0000"></div>
        </div>
        <div class="dm-field">
          <label>NÃºmero de habitaciones</label>
          <select id="dm-rooms">
            <option value="">Selecciona...</option>
            <option>1 â€“ 10 habitaciones</option>
            <option>11 â€“ 25 habitaciones</option>
            <option>26 â€“ 50 habitaciones</option>
            <option>51 â€“ 100 habitaciones</option>
            <option>MÃ¡s de 100</option>
          </select>
        </div>
      </div>

      <!-- Slide 3: desafÃ­os -->
      <div class="dm-slide" id="dm-slide-3">
        <p style="font-family:var(--font-sans);font-size:13px;color:#6b7280;margin-bottom:0.25rem;">Â¿CuÃ¡l es tu mayor desafÃ­o operativo?</p>
        <p style="font-family:var(--font-sans);font-size:11px;color:#9ca3af;margin-bottom:0;">Selecciona todos los que apliquen.</p>
        <div class="dm-check-list">
          {{ range slice
            "GestiÃ³n de reservas caÃ³tica"
            "Check-in / check-out manual y lento"
            "Poca visibilidad de ingresos y reportes"
            "Housekeeping descoordinada"
            "FacturaciÃ³n y cobros complicados"
            "Todo lo anterior ğŸ˜…"
          }}
          <label class="dm-check-item" onclick="this.classList.toggle('checked')">
            <input type="checkbox" value="{{ . }}">{{ . }}
          </label>
          {{ end }}
        </div>
        <p style="font-family:var(--font-sans);font-size:11px;color:#9ca3af;text-align:center;padding:0.75rem 0 0.25rem;">Sin tarjeta de crÃ©dito Â· Respondemos en menos de 24 h</p>
      </div>

    </div><!-- /dm-right -->
  </div><!-- /dm-inner -->

  <!-- FOOTER -->
  <div id="dm-footer">
    <button id="dm-back-btn" class="hidden" onclick="dmPrev()">â† Volver</button>
    <span id="dm-counter" style="font-family:var(--font-sans);font-size:13px;color:#9ca3af;">1 de 3</span>
    <button id="dm-next-btn" onclick="dmNext()" disabled>Siguiente â†’</button>
  </div>

</div><!-- /demo-card -->
</div><!-- /demo-overlay -->

<script>
var DM_API = "{{ .Site.Params.demoFormUrl }}";
var SUBTITLES = ['Tipo de propiedad','Datos de contacto','Tu mayor desafÃ­o'];
var dm = { step:1, tipo:'' };

function openDemoModal() {
  dmReset();
  document.getElementById('demo-overlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}
function closeDemoModal() {
  document.getElementById('demo-overlay').classList.remove('open');
  document.body.style.overflow = '';
}
document.addEventListener('keydown', function(e){ if(e.key==='Escape') closeDemoModal(); });

function dmReset() {
  dm = { step:1, tipo:'' };
  document.getElementById('dm-success').classList.remove('show');
  document.getElementById('dm-success').style.display = 'none';
  document.getElementById('dm-inner').style.display = '';
  document.getElementById('dm-footer').style.display = '';
  document.querySelectorAll('.dm-slide').forEach(function(s){ s.classList.remove('active','exit-up'); });
  document.getElementById('dm-slide-1').classList.add('active');
  document.querySelectorAll('.dm-type-card').forEach(function(c){ c.classList.remove('selected'); });
  ['dm-nombre','dm-hotel','dm-email','dm-tel','dm-rooms'].forEach(function(id){ var e=document.getElementById(id); if(e) e.value=''; });
  document.querySelectorAll('.dm-check-item').forEach(function(c){ c.classList.remove('checked'); });
  document.querySelectorAll('.dm-check-item input').forEach(function(c){ c.checked=false; });
  var nb = document.getElementById('dm-next-btn');
  nb.disabled = true; nb.innerHTML = 'Siguiente â†’';
  dmSyncUI();
}

function dmSyncUI() {
  var n = dm.step;
  document.getElementById('dm-counter').textContent = n + ' de 3';
  document.getElementById('dm-left-sub').textContent = SUBTITLES[n-1];
  document.getElementById('dm-back-btn').className = n > 1 ? '' : 'hidden';
  document.getElementById('dm-next-btn').innerHTML = n < 3 ? 'Siguiente â†’' : 'Solicitar demo â†—';
  for (var i=1; i<=3; i++) {
    var d = document.getElementById('dd'+i);
    d.className = 'dm-dot';
    if (i < n) d.classList.add('done');
    else if (i === n) d.classList.add('active');
  }
}

function dmGoStep(to) {
  var fromEl = document.getElementById('dm-slide-' + dm.step);
  var toEl   = document.getElementById('dm-slide-' + to);
  fromEl.classList.remove('active');
  fromEl.classList.add('exit-up');
  setTimeout(function(){ fromEl.classList.remove('exit-up'); }, 260);
  setTimeout(function(){ toEl.classList.add('active'); }, 50);
  dm.step = to;
  document.getElementById('dm-next-btn').disabled = false;
  dmSyncUI();
}

function dmPrev() { if (dm.step > 1) dmGoStep(dm.step - 1); }

function dmNext() {
  if (dm.step === 1) {
    if (!dm.tipo) return;
    dmGoStep(2);
  } else if (dm.step === 2) {
    var n=document.getElementById('dm-nombre').value.trim(),
        h=document.getElementById('dm-hotel').value.trim(),
        e=document.getElementById('dm-email').value.trim(),
        t=document.getElementById('dm-tel').value.trim();
    if (!n||!h||!e||!t) { alert('Por favor completa todos los campos obligatorios (*).'); return; }
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)) { alert('Email invÃ¡lido.'); return; }
    dmGoStep(3);
  } else {
    dmSubmit();
  }
}

function selectType(card) {
  document.querySelectorAll('.dm-type-card').forEach(function(c){ c.classList.remove('selected'); });
  card.classList.add('selected');
  dm.tipo = card.dataset.value;
  document.getElementById('dm-next-btn').disabled = false;
}

function dmSubmit() {
  var btn = document.getElementById('dm-next-btn');
  btn.disabled = true;
  btn.innerHTML = '<span style="display:inline-block;width:13px;height:13px;border:2px solid #0A0A0A;border-top-color:transparent;border-radius:50%;animation:dmSpin 0.6s linear infinite;vertical-align:middle;margin-right:5px;"></span>Enviando...';
  var desafios = [];
  document.querySelectorAll('.dm-check-item input:checked').forEach(function(c){ desafios.push(c.value); });
  fetch(DM_API, {
    method:'POST',
    headers:{'Content-Type':'application/json','Accept':'application/json'},
    body: JSON.stringify({
      tipo_propiedad: dm.tipo,
      nombre:   document.getElementById('dm-nombre').value.trim(),
      hotel:    document.getElementById('dm-hotel').value.trim(),
      email:    document.getElementById('dm-email').value.trim(),
      telefono: document.getElementById('dm-tel').value.trim(),
      habitaciones: document.getElementById('dm-rooms').value || 'No especificado',
      desafios: desafios.join(', ') || 'No especificado',
    })
  })
  .then(function(r){ return r.json(); })
  .then(function(){ dmShowSuccess(); })
  .catch(function(){ dmShowSuccess(); });
}

function dmShowSuccess() {
  document.getElementById('dm-inner').style.display = 'none';
  document.getElementById('dm-footer').style.display = 'none';
  var s = document.getElementById('dm-success');
  s.style.display = 'flex';
  setTimeout(function(){ s.classList.add('show'); }, 10);
}
</script>
